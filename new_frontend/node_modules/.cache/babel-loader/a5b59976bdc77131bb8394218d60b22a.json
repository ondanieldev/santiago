{"ast":null,"code":"import _regeneratorRuntime from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useRef,useState}from'react';import{Form}from'@unform/web';import{FiUser,FiLock}from'react-icons/fi';import*as Yup from'yup';import{toast}from'react-toastify';import{Container,Content,AnimatedContent,Background}from'./styles';import{useAuth}from'../../hooks/auth';import Input from'../../components/Input';import Button from'../../components/Button';import getValidationErrors from'../../utils/getValidationErrors';toast.configure();var SignIn=function SignIn(){var formRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useAuth=useAuth(),signIn=_useAuth.signIn;var handleSignIn=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var _formRef$current,schema,_formRef$current2,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!loading){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.prev=2;setLoading(true);(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});schema=Yup.object().shape({username:Yup.string().required('Nome de usuário obrigatório'),password:Yup.string().required('Senha obrigatória')});_context.next=8;return schema.validate(data,{abortEarly:false});case 8:_context.next=10;return signIn({username:data.username,password:data.password});case 10:_context.next=19;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);if(!(_context.t0 instanceof Yup.ValidationError)){_context.next=18;break;}errors=getValidationErrors(_context.t0);(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setErrors(errors);return _context.abrupt(\"return\");case 18:toast.error('Credenciais incorretas!');case 19:_context.prev=19;setLoading(false);return _context.finish(19);case 22:case\"end\":return _context.stop();}}},_callee,null,[[2,12,19,22]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[signIn,loading]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Content,null,/*#__PURE__*/React.createElement(AnimatedContent,null,/*#__PURE__*/React.createElement(\"h1\",null,\"Fa\\xE7a seu login\"),/*#__PURE__*/React.createElement(Form,{ref:formRef,onSubmit:handleSignIn},/*#__PURE__*/React.createElement(Input,{icon:FiUser,name:\"username\",placeholder:\"Usu\\xE1rio\",autoComplete:\"off\"}),/*#__PURE__*/React.createElement(Input,{icon:FiLock,name:\"password\",placeholder:\"Senha\",type:\"password\"}),/*#__PURE__*/React.createElement(Button,{loading:loading,type:\"submit\"},\"Entrar\")))),/*#__PURE__*/React.createElement(Background,null));};export default SignIn;","map":{"version":3,"sources":["/home/ondaniel/santiago/sisgie/new_frontend/src/pages/SignIn/index.tsx"],"names":["React","useCallback","useRef","useState","Form","FiUser","FiLock","Yup","toast","Container","Content","AnimatedContent","Background","useAuth","Input","Button","getValidationErrors","configure","SignIn","formRef","loading","setLoading","signIn","handleSignIn","data","current","setErrors","schema","object","shape","username","string","required","password","validate","abortEarly","ValidationError","errors","error"],"mappings":"uXAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,MAA7B,CAAqCC,QAArC,KAAqD,OAArD,CAEA,OAASC,IAAT,KAAqB,aAArB,CACA,OAASC,MAAT,CAAiBC,MAAjB,KAA+B,gBAA/B,CACA,MAAO,GAAKC,CAAAA,GAAZ,KAAqB,KAArB,CAEA,OAASC,KAAT,KAAsB,gBAAtB,CACA,OAASC,SAAT,CAAoBC,OAApB,CAA6BC,eAA7B,CAA8CC,UAA9C,KAAgE,UAAhE,CACA,OAASC,OAAT,KAAwB,kBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,wBAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,CACA,MAAOC,CAAAA,mBAAP,KAAgC,iCAAhC,CAOAR,KAAK,CAACS,SAAN,GAEA,GAAMC,CAAAA,MAAgB,CAAG,QAAnBA,CAAAA,MAAmB,EAAM,CAC7B,GAAMC,CAAAA,OAAO,CAAGjB,MAAM,CAAc,IAAd,CAAtB,CAD6B,cAGCC,QAAQ,CAAC,KAAD,CAHT,wCAGtBiB,OAHsB,eAGbC,UAHa,4BAKVR,OAAO,EALG,CAKrBS,MALqB,UAKrBA,MALqB,CAO7B,GAAMC,CAAAA,YAAY,CAAGtB,WAAW,0FAC9B,iBAAOuB,IAAP,2KACMJ,OADN,iFAMIC,UAAU,CAAC,IAAD,CAAV,CAEA,kBAAAF,OAAO,CAACM,OAAR,4DAAiBC,SAAjB,CAA2B,EAA3B,EAEMC,MAVV,CAUmBpB,GAAG,CAACqB,MAAJ,GAAaC,KAAb,CAAmB,CAChCC,QAAQ,CAAEvB,GAAG,CAACwB,MAAJ,GAAaC,QAAb,CAAsB,6BAAtB,CADsB,CAEhCC,QAAQ,CAAE1B,GAAG,CAACwB,MAAJ,GAAaC,QAAb,CAAsB,mBAAtB,CAFsB,CAAnB,CAVnB,uBAeUL,CAAAA,MAAM,CAACO,QAAP,CAAgBV,IAAhB,CAAsB,CAC1BW,UAAU,CAAE,KADc,CAAtB,CAfV,+BAmBUb,CAAAA,MAAM,CAAC,CACXQ,QAAQ,CAAEN,IAAI,CAACM,QADJ,CAEXG,QAAQ,CAAET,IAAI,CAACS,QAFJ,CAAD,CAnBhB,+FAwBQ,sBAAe1B,CAAAA,GAAG,CAAC6B,eAxB3B,2BAyBYC,MAzBZ,CAyBqBrB,mBAAmB,aAzBxC,CA0BM,mBAAAG,OAAO,CAACM,OAAR,8DAAiBC,SAAjB,CAA2BW,MAA3B,EA1BN,yCA8BI7B,KAAK,CAAC8B,KAAN,CAAY,yBAAZ,EA9BJ,yBAgCIjB,UAAU,CAAC,KAAD,CAAV,CAhCJ,sGAD8B,+DAoC9B,CAACC,MAAD,CAASF,OAAT,CApC8B,CAAhC,CAuCA,mBACE,oBAAC,SAAD,mBACE,oBAAC,OAAD,mBACE,oBAAC,eAAD,mBACE,kDADF,cAGE,oBAAC,IAAD,EAAM,GAAG,CAAED,OAAX,CAAoB,QAAQ,CAAEI,YAA9B,eACE,oBAAC,KAAD,EACE,IAAI,CAAElB,MADR,CAEE,IAAI,CAAC,UAFP,CAGE,WAAW,CAAC,YAHd,CAIE,YAAY,CAAC,KAJf,EADF,cAQE,oBAAC,KAAD,EACE,IAAI,CAAEC,MADR,CAEE,IAAI,CAAC,UAFP,CAGE,WAAW,CAAC,OAHd,CAIE,IAAI,CAAC,UAJP,EARF,cAeE,oBAAC,MAAD,EAAQ,OAAO,CAAEc,OAAjB,CAA0B,IAAI,CAAC,QAA/B,WAfF,CAHF,CADF,CADF,cA2BE,oBAAC,UAAD,MA3BF,CADF,CA+BD,CA7ED,CA+EA,cAAeF,CAAAA,MAAf","sourcesContent":["import React, { useCallback, useRef, useState } from 'react';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { FiUser, FiLock } from 'react-icons/fi';\nimport * as Yup from 'yup';\n\nimport { toast } from 'react-toastify';\nimport { Container, Content, AnimatedContent, Background } from './styles';\nimport { useAuth } from '../../hooks/auth';\nimport Input from '../../components/Input';\nimport Button from '../../components/Button';\nimport getValidationErrors from '../../utils/getValidationErrors';\n\ninterface SignInFormData {\n  username: string;\n  password: string;\n}\n\ntoast.configure();\n\nconst SignIn: React.FC = () => {\n  const formRef = useRef<FormHandles>(null);\n\n  const [loading, setLoading] = useState(false);\n\n  const { signIn } = useAuth();\n\n  const handleSignIn = useCallback(\n    async (data: SignInFormData) => {\n      if (loading) {\n        return;\n      }\n\n      try {\n        setLoading(true);\n\n        formRef.current?.setErrors({});\n\n        const schema = Yup.object().shape({\n          username: Yup.string().required('Nome de usuário obrigatório'),\n          password: Yup.string().required('Senha obrigatória'),\n        });\n\n        await schema.validate(data, {\n          abortEarly: false,\n        });\n\n        await signIn({\n          username: data.username,\n          password: data.password,\n        });\n      } catch (err) {\n        if (err instanceof Yup.ValidationError) {\n          const errors = getValidationErrors(err);\n          formRef.current?.setErrors(errors);\n          return;\n        }\n\n        toast.error('Credenciais incorretas!');\n      } finally {\n        setLoading(false);\n      }\n    },\n    [signIn, loading],\n  );\n\n  return (\n    <Container>\n      <Content>\n        <AnimatedContent>\n          <h1>Faça seu login</h1>\n\n          <Form ref={formRef} onSubmit={handleSignIn}>\n            <Input\n              icon={FiUser}\n              name=\"username\"\n              placeholder=\"Usuário\"\n              autoComplete=\"off\"\n            />\n\n            <Input\n              icon={FiLock}\n              name=\"password\"\n              placeholder=\"Senha\"\n              type=\"password\"\n            />\n\n            <Button loading={loading} type=\"submit\">\n              Entrar\n            </Button>\n          </Form>\n        </AnimatedContent>\n      </Content>\n\n      <Background />\n    </Container>\n  );\n};\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}