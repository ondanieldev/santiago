{"ast":null,"code":"import _regeneratorRuntime from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useEffect,useRef}from'react';import{Form}from'@unform/web';import{FiBriefcase,FiEdit2}from'react-icons/fi';import{ValidationError as YupValidationError}from'yup';import{toast}from'react-toastify';import{Container,Main,ButtonGroup,DoubleColumn}from'./styles';import Loading from'../../components/Loading';import Header from'../../components/Header';import Aside from'../../components/Aside';import Title from'../../components/Title';import Input from'../../components/Input';import Checkbox from'../../components/Checkbox';import Button from'../../components/Button';import ProfilesList from'../../components/List';import api from'../../services/api';import profileSchema from'../../schemas/profileSchema';import getValidationErrors from'../../utils/getValidationErrors';var Profiles=function Profiles(){var formRef=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),profiles=_useState2[0],setProfiles=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),profileId=_useState4[0],setProfileId=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loadingPage=_useState6[0],setLoadingPage=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loadingSubmit=_useState8[0],setLoadingSubmit=_useState8[1];useEffect(function(){setLoadingPage(true);api.get('/profiles').then(function(response){return setProfiles(response.data);}).catch(function(){toast.error('Erro ao carregar perfis! Por favor, tente novamente mais tarde.');}).finally(function(){setLoadingPage(false);});},[]);var handleGetProfile=useCallback(function(data){var _formRef$current,_formRef$current2;setProfileId(data.id);(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setData(data);},[]);var handleUngetProfile=useCallback(function(){var _formRef$current3,_formRef$current4;setProfileId('');(_formRef$current3=formRef.current)===null||_formRef$current3===void 0?void 0:_formRef$current3.setErrors({});(_formRef$current4=formRef.current)===null||_formRef$current4===void 0?void 0:_formRef$current4.reset();},[]);var handleAddProfile=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data,_ref){var reset,_formRef$current5,response,_formRef$current6,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:reset=_ref.reset;if(!loadingSubmit){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setLoadingSubmit(true);_context.prev=4;(_formRef$current5=formRef.current)===null||_formRef$current5===void 0?void 0:_formRef$current5.setErrors({});_context.next=8;return profileSchema.validate(data,{abortEarly:false});case 8:_context.next=10;return api.post('/profiles',data);case 10:response=_context.sent;setProfiles([].concat(_toConsumableArray(profiles),[response.data]));reset();toast.success('Perfil criado com sucesso!');_context.next=23;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](4);if(!(_context.t0 instanceof YupValidationError)){_context.next=22;break;}errors=getValidationErrors(_context.t0);(_formRef$current6=formRef.current)===null||_formRef$current6===void 0?void 0:_formRef$current6.setErrors(errors);return _context.abrupt(\"return\");case 22:if(_context.t0.response){toast.error(\"Erro ao criar perfil: \".concat(_context.t0.response.data.message));}else{toast.error('Erro interno do servidor! Por favor, tente novamente mais tarde.');}case 23:_context.prev=23;setLoadingSubmit(false);return _context.finish(23);case 26:case\"end\":return _context.stop();}}},_callee,null,[[4,16,23,26]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}(),[profiles,loadingSubmit]);var handleUpdateProfile=useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data,_ref3){var reset,_formRef$current7,response,profilesWithoutEdited,_formRef$current8,errors;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:reset=_ref3.reset;if(!loadingSubmit){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:setLoadingSubmit(true);_context2.prev=4;(_formRef$current7=formRef.current)===null||_formRef$current7===void 0?void 0:_formRef$current7.setErrors({});_context2.next=8;return profileSchema.validate(data,{abortEarly:false});case 8:_context2.next=10;return api.put(\"/profiles/\".concat(profileId),data);case 10:response=_context2.sent;profilesWithoutEdited=profiles.filter(function(profile){return profile.id!==profileId;});setProfiles([].concat(_toConsumableArray(profilesWithoutEdited),[response.data]));setProfileId('');reset();toast.success('Perfil atualizado com sucesso!');_context2.next=25;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](4);if(!(_context2.t0 instanceof YupValidationError)){_context2.next=24;break;}errors=getValidationErrors(_context2.t0);(_formRef$current8=formRef.current)===null||_formRef$current8===void 0?void 0:_formRef$current8.setErrors(errors);return _context2.abrupt(\"return\");case 24:if(_context2.t0.response){toast.error(\"Erro ao atualizar perfil: \".concat(_context2.t0.response.data.message));}else{toast.error('Erro interno do servidor! Por favor tente novamente mais tarde.');}case 25:_context2.prev=25;setLoadingSubmit(false);return _context2.finish(25);case 28:case\"end\":return _context2.stop();}}},_callee2,null,[[4,18,25,28]]);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}(),[profiles,profileId,loadingSubmit]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Loading,{show:loadingPage}),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(Aside,null),/*#__PURE__*/React.createElement(Main,null,/*#__PURE__*/React.createElement(Title,{title:\"Gerenciar perfis\"}),/*#__PURE__*/React.createElement(DoubleColumn,null,/*#__PURE__*/React.createElement(Form,{ref:formRef,onSubmit:!profileId?handleAddProfile:handleUpdateProfile},/*#__PURE__*/React.createElement(Input,{placeholder:\"Nome\",name:\"name\",icon:FiBriefcase}),/*#__PURE__*/React.createElement(Checkbox,{name:\"new_enrollment_permiss\",label:\"Criar nova matr\\xEDcula\"}),/*#__PURE__*/React.createElement(Checkbox,{name:\"validate_enrollment_permiss\",label:\"Aprovar e desaprovar matr\\xEDculas\"}),/*#__PURE__*/React.createElement(Checkbox,{name:\"pay_debit_permiss\",label:\"Pagar d\\xE9bitos\"}),/*#__PURE__*/React.createElement(Checkbox,{name:\"discharge_payment_permiss\",label:\"Receber pagamentos\"}),/*#__PURE__*/React.createElement(Checkbox,{name:\"crud_profiles_permiss\",label:\"Gerenciar perfis\"}),/*#__PURE__*/React.createElement(Checkbox,{name:\"crud_users_permiss\",label:\"Gerenciar usu\\xE1rios\"}),/*#__PURE__*/React.createElement(Checkbox,{name:\"crud_grades_permiss\",label:\"Gerenciar turmas\"}),/*#__PURE__*/React.createElement(ButtonGroup,null,!profileId?/*#__PURE__*/React.createElement(Button,{type:\"submit\",loading:loadingSubmit},\"Adicionar\"):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{type:\"submit\",loading:loadingSubmit},\"Atualizar\"),/*#__PURE__*/React.createElement(Button,{type:\"submit\",backgroundColor:\"#f44336\",onClick:handleUngetProfile},\"Cancelar\")))),profiles.length>0&&/*#__PURE__*/React.createElement(ProfilesList,null,profiles.map(function(profile){return/*#__PURE__*/React.createElement(\"li\",{key:profile.id},/*#__PURE__*/React.createElement(FiEdit2,{size:20,onClick:function onClick(){return handleGetProfile(profile);}}),/*#__PURE__*/React.createElement(\"span\",null,profile.name));})))));};export default Profiles;","map":{"version":3,"sources":["/home/ondaniel/santiago/sisgie/new_frontend/src/pages/Profiles/index.tsx"],"names":["React","useState","useCallback","useEffect","useRef","Form","FiBriefcase","FiEdit2","ValidationError","YupValidationError","toast","Container","Main","ButtonGroup","DoubleColumn","Loading","Header","Aside","Title","Input","Checkbox","Button","ProfilesList","api","profileSchema","getValidationErrors","Profiles","formRef","profiles","setProfiles","profileId","setProfileId","loadingPage","setLoadingPage","loadingSubmit","setLoadingSubmit","get","then","response","data","catch","error","finally","handleGetProfile","id","current","setErrors","setData","handleUngetProfile","reset","handleAddProfile","validate","abortEarly","post","success","errors","message","handleUpdateProfile","put","profilesWithoutEdited","filter","profile","length","map","name"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect, useRef } from 'react';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { FiBriefcase, FiEdit2 } from 'react-icons/fi';\nimport { ValidationError as YupValidationError } from 'yup';\nimport { toast } from 'react-toastify';\n\nimport { Container, Main, ButtonGroup, DoubleColumn } from './styles';\nimport Loading from '../../components/Loading';\nimport Header from '../../components/Header';\nimport Aside from '../../components/Aside';\nimport Title from '../../components/Title';\nimport Input from '../../components/Input';\nimport Checkbox from '../../components/Checkbox';\nimport Button from '../../components/Button';\nimport ProfilesList from '../../components/List';\nimport IProfile from '../../entities/IProfile';\nimport api from '../../services/api';\nimport profileSchema from '../../schemas/profileSchema';\nimport getValidationErrors from '../../utils/getValidationErrors';\n\nconst Profiles: React.FC = () => {\n  const formRef = useRef<FormHandles>(null);\n\n  const [profiles, setProfiles] = useState([] as IProfile[]);\n  const [profileId, setProfileId] = useState('');\n  const [loadingPage, setLoadingPage] = useState(false);\n  const [loadingSubmit, setLoadingSubmit] = useState(false);\n\n  useEffect(() => {\n    setLoadingPage(true);\n    api\n      .get('/profiles')\n      .then(response => setProfiles(response.data))\n      .catch(() => {\n        toast.error(\n          'Erro ao carregar perfis! Por favor, tente novamente mais tarde.',\n        );\n      })\n      .finally(() => {\n        setLoadingPage(false);\n      });\n  }, []);\n\n  const handleGetProfile = useCallback((data: IProfile) => {\n    setProfileId(data.id);\n\n    formRef.current?.setErrors({});\n\n    formRef.current?.setData(data);\n  }, []);\n\n  const handleUngetProfile = useCallback(() => {\n    setProfileId('');\n\n    formRef.current?.setErrors({});\n\n    formRef.current?.reset();\n  }, []);\n\n  const handleAddProfile = useCallback(\n    async (data: Omit<IProfile, 'id'>, { reset }) => {\n      if (loadingSubmit) {\n        return;\n      }\n\n      setLoadingSubmit(true);\n\n      try {\n        formRef.current?.setErrors({});\n\n        await profileSchema.validate(data, {\n          abortEarly: false,\n        });\n\n        const response = await api.post('/profiles', data);\n\n        setProfiles([...profiles, response.data]);\n\n        reset();\n\n        toast.success('Perfil criado com sucesso!');\n      } catch (err) {\n        if (err instanceof YupValidationError) {\n          const errors = getValidationErrors(err);\n          formRef.current?.setErrors(errors);\n          return;\n        }\n\n        if (err.response) {\n          toast.error(`Erro ao criar perfil: ${err.response.data.message}`);\n        } else {\n          toast.error(\n            'Erro interno do servidor! Por favor, tente novamente mais tarde.',\n          );\n        }\n      } finally {\n        setLoadingSubmit(false);\n      }\n    },\n    [profiles, loadingSubmit],\n  );\n\n  const handleUpdateProfile = useCallback(\n    async (data: Omit<IProfile, 'id'>, { reset }) => {\n      if (loadingSubmit) {\n        return;\n      }\n\n      setLoadingSubmit(true);\n\n      try {\n        formRef.current?.setErrors({});\n\n        await profileSchema.validate(data, {\n          abortEarly: false,\n        });\n\n        const response = await api.put(`/profiles/${profileId}`, data);\n\n        const profilesWithoutEdited = profiles.filter(\n          profile => profile.id !== profileId,\n        );\n\n        setProfiles([...profilesWithoutEdited, response.data]);\n\n        setProfileId('');\n\n        reset();\n\n        toast.success('Perfil atualizado com sucesso!');\n      } catch (err) {\n        if (err instanceof YupValidationError) {\n          const errors = getValidationErrors(err);\n          formRef.current?.setErrors(errors);\n          return;\n        }\n\n        if (err.response) {\n          toast.error(`Erro ao atualizar perfil: ${err.response.data.message}`);\n        } else {\n          toast.error(\n            'Erro interno do servidor! Por favor tente novamente mais tarde.',\n          );\n        }\n      } finally {\n        setLoadingSubmit(false);\n      }\n    },\n    [profiles, profileId, loadingSubmit],\n  );\n\n  return (\n    <Container>\n      <Loading show={loadingPage} />\n\n      <Header />\n\n      <Aside />\n\n      <Main>\n        <Title title=\"Gerenciar perfis\" />\n\n        <DoubleColumn>\n          <Form\n            ref={formRef}\n            onSubmit={!profileId ? handleAddProfile : handleUpdateProfile}\n          >\n            <Input placeholder=\"Nome\" name=\"name\" icon={FiBriefcase} />\n\n            <Checkbox\n              name=\"new_enrollment_permiss\"\n              label=\"Criar nova matrícula\"\n            />\n\n            <Checkbox\n              name=\"validate_enrollment_permiss\"\n              label=\"Aprovar e desaprovar matrículas\"\n            />\n\n            <Checkbox name=\"pay_debit_permiss\" label=\"Pagar débitos\" />\n\n            <Checkbox\n              name=\"discharge_payment_permiss\"\n              label=\"Receber pagamentos\"\n            />\n\n            <Checkbox name=\"crud_profiles_permiss\" label=\"Gerenciar perfis\" />\n\n            <Checkbox name=\"crud_users_permiss\" label=\"Gerenciar usuários\" />\n\n            <Checkbox name=\"crud_grades_permiss\" label=\"Gerenciar turmas\" />\n\n            <ButtonGroup>\n              {!profileId ? (\n                <Button type=\"submit\" loading={loadingSubmit}>\n                  Adicionar\n                </Button>\n              ) : (\n                <>\n                  <Button type=\"submit\" loading={loadingSubmit}>\n                    Atualizar\n                  </Button>\n\n                  <Button\n                    type=\"submit\"\n                    backgroundColor=\"#f44336\"\n                    onClick={handleUngetProfile}\n                  >\n                    Cancelar\n                  </Button>\n                </>\n              )}\n            </ButtonGroup>\n          </Form>\n\n          {profiles.length > 0 && (\n            <ProfilesList>\n              {profiles.map(profile => (\n                <li key={profile.id}>\n                  <FiEdit2\n                    size={20}\n                    onClick={() => handleGetProfile(profile)}\n                  />\n                  {/* <FiTrash\n                    size={20}\n                    onClick={() => handleRemoveProfile(profile.id)}\n                  /> */}\n                  <span>{profile.name}</span>\n                </li>\n              ))}\n            </ProfilesList>\n          )}\n        </DoubleColumn>\n      </Main>\n    </Container>\n  );\n};\n\nexport default Profiles;\n"]},"metadata":{},"sourceType":"module"}