{"ast":null,"code":"import _regeneratorRuntime from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useCallback,useRef}from'react';import{Form}from'@unform/web';import{toast}from'react-toastify';import{Container}from'./styles';import Table from'../Table';import Input from'../Input';import Button from'../Button';import Loading from'../Loading';import api from'../../services/api';var Enrollments=function Enrollments(_ref){var apiUrl=_ref.apiUrl,handleSelectEnrollment=_ref.handleSelectEnrollment,showSearch=_ref.showSearch,searchApiUrl=_ref.searchApiUrl;var formRef=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),enrollments=_useState2[0],setEnrollments=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingPage=_useState4[0],setLoadingPage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loadingSearch=_useState6[0],setLoadingSearch=_useState6[1];useEffect(function(){setLoadingPage(true);api.get(apiUrl).then(function(response){setEnrollments(response.data||[]);}).catch(function(){toast.error('Erro ao buscar matrículas! Por favor, tente novamente mais tarde.');}).finally(function(){setLoadingPage(false);});},[apiUrl]);var formatStatus=useCallback(function(status){switch(status){case'underAnalysis':return'Em análise';case'pendent':return'Pendente';case'accepted':return'Aceito';case'active':return'Ativo';default:return'-';}},[]);var handleSubmitForm=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2){var student_name,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:student_name=_ref2.student_name;setLoadingSearch(true);_context.prev=2;_context.next=5;return api.get(\"\".concat(searchApiUrl,\"/\").concat(student_name));case 5:response=_context.sent;setEnrollments(response.data);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);api.get(apiUrl).then(function(response){setEnrollments(response.data||[]);});case 12:_context.prev=12;setLoadingSearch(false);return _context.finish(12);case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,9,12,15]]);}));return function(_x){return _ref3.apply(this,arguments);};}(),[apiUrl,searchApiUrl]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Loading,{show:loadingPage}),showSearch&&/*#__PURE__*/React.createElement(Form,{onSubmit:handleSubmitForm,ref:formRef},/*#__PURE__*/React.createElement(Input,{name:\"student_name\",placeholder:\"Pesquisar por nome do aluno\"}),/*#__PURE__*/React.createElement(Button,{type:\"submit\",loading:loadingSearch},\"Pesquisar\")),/*#__PURE__*/React.createElement(Table,{isVoid:enrollments.length<=0,voidMessage:\"N\\xE3o h\\xE1 matr\\xEDculas nesta se\\xE7\\xE3o!\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,\"#\"),/*#__PURE__*/React.createElement(\"td\",null,\"Status\"),/*#__PURE__*/React.createElement(\"td\",null,\"Aluno\"),/*#__PURE__*/React.createElement(\"td\",null,\"Turma\"))),/*#__PURE__*/React.createElement(\"tbody\",null,enrollments.map(function(enrollment){return/*#__PURE__*/React.createElement(\"tr\",{key:enrollment.id,onClick:function onClick(){return handleSelectEnrollment(enrollment.id);}},/*#__PURE__*/React.createElement(\"td\",null,enrollment.id),/*#__PURE__*/React.createElement(\"td\",null,formatStatus(enrollment.status)),/*#__PURE__*/React.createElement(\"td\",null,enrollment.student.name),/*#__PURE__*/React.createElement(\"td\",null,enrollment.grade.name));}))));};export default Enrollments;","map":{"version":3,"sources":["/home/ondaniel/santiago/sisgie/new_frontend/src/components/Enrollments/index.tsx"],"names":["React","useEffect","useState","useCallback","useRef","Form","toast","Container","Table","Input","Button","Loading","api","Enrollments","apiUrl","handleSelectEnrollment","showSearch","searchApiUrl","formRef","enrollments","setEnrollments","loadingPage","setLoadingPage","loadingSearch","setLoadingSearch","get","then","response","data","catch","error","finally","formatStatus","status","handleSubmitForm","student_name","length","map","enrollment","id","student","name","grade"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useCallback, useRef } from 'react';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { toast } from 'react-toastify';\n\nimport { Container } from './styles';\nimport Table from '../Table';\nimport Input from '../Input';\nimport Button from '../Button';\nimport Loading from '../Loading';\nimport api from '../../services/api';\n\ninterface IProps {\n  apiUrl: string;\n  handleSelectEnrollment(id: string): void;\n  showSearch?: boolean;\n  searchApiUrl?: string;\n}\n\ninterface IEnrollment {\n  id: string;\n  status: 'accepted' | 'active' | 'underAnalysis' | 'pendent';\n  student: {\n    name: string;\n  };\n  grade: {\n    name: string;\n    year: string;\n  };\n}\n\ninterface IFormData {\n  student_name: string;\n}\n\nconst Enrollments: React.FC<IProps> = ({\n  apiUrl,\n  handleSelectEnrollment,\n  showSearch,\n  searchApiUrl,\n}) => {\n  const formRef = useRef<FormHandles>(null);\n\n  const [enrollments, setEnrollments] = useState([] as IEnrollment[]);\n  const [loadingPage, setLoadingPage] = useState(false);\n  const [loadingSearch, setLoadingSearch] = useState(false);\n\n  useEffect(() => {\n    setLoadingPage(true);\n\n    api\n      .get(apiUrl)\n      .then(response => {\n        setEnrollments(response.data || []);\n      })\n      .catch(() => {\n        toast.error(\n          'Erro ao buscar matrículas! Por favor, tente novamente mais tarde.',\n        );\n      })\n      .finally(() => {\n        setLoadingPage(false);\n      });\n  }, [apiUrl]);\n\n  const formatStatus = useCallback(\n    (status: 'underAnalysis' | 'pendent' | 'accepted' | 'active') => {\n      switch (status) {\n        case 'underAnalysis':\n          return 'Em análise';\n        case 'pendent':\n          return 'Pendente';\n        case 'accepted':\n          return 'Aceito';\n        case 'active':\n          return 'Ativo';\n        default:\n          return '-';\n      }\n    },\n    [],\n  );\n\n  const handleSubmitForm = useCallback(\n    async ({ student_name }: IFormData) => {\n      setLoadingSearch(true);\n\n      try {\n        const response = await api.get(`${searchApiUrl}/${student_name}`);\n        setEnrollments(response.data);\n      } catch {\n        api.get(apiUrl).then(response => {\n          setEnrollments(response.data || []);\n        });\n      } finally {\n        setLoadingSearch(false);\n      }\n    },\n    [apiUrl, searchApiUrl],\n  );\n\n  return (\n    <Container>\n      <Loading show={loadingPage} />\n\n      {showSearch && (\n        <Form onSubmit={handleSubmitForm} ref={formRef}>\n          <Input\n            name=\"student_name\"\n            placeholder=\"Pesquisar por nome do aluno\"\n          />\n\n          <Button type=\"submit\" loading={loadingSearch}>\n            Pesquisar\n          </Button>\n        </Form>\n      )}\n\n      <Table\n        isVoid={enrollments.length <= 0}\n        voidMessage=\"Não há matrículas nesta seção!\"\n      >\n        <thead>\n          <tr>\n            <td>#</td>\n            <td>Status</td>\n            <td>Aluno</td>\n            <td>Turma</td>\n          </tr>\n        </thead>\n        <tbody>\n          {enrollments.map(enrollment => (\n            <tr\n              key={enrollment.id}\n              onClick={() => handleSelectEnrollment(enrollment.id)}\n            >\n              <td>{enrollment.id}</td>\n              <td>{formatStatus(enrollment.status)}</td>\n              <td>{enrollment.student.name}</td>\n              <td>{enrollment.grade.name}</td>\n            </tr>\n          ))}\n        </tbody>\n      </Table>\n    </Container>\n  );\n};\n\nexport default Enrollments;\n"]},"metadata":{},"sourceType":"module"}