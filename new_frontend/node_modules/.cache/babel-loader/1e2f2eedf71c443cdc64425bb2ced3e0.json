{"ast":null,"code":"import _regeneratorRuntime from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useEffect,useRef}from'react';import{Form}from'@unform/web';import{FiUser,FiBriefcase,FiLock,FiEdit2}from'react-icons/fi';import{ValidationError as YupValidationError}from'yup';import{toast}from'react-toastify';import{Container,Main,ButtonGroup,DoubleColumn}from'./styles';import Loading from'../../components/Loading';import Header from'../../components/Header';import Aside from'../../components/Aside';import Title from'../../components/Title';import Input from'../../components/Input';import Select from'../../components/Select';import Button from'../../components/Button';import UsersList from'../../components/List';import api from'../../services/api';import userSchema from'../../schemas/userSchema';import getValidationErrors from'../../utils/getValidationErrors';var Users=function Users(){var formRef=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),profiles=_useState4[0],setProfiles=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loadingPage=_useState8[0],setLoadingPage=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loadingSubmit=_useState10[0],setLoadingSubmit=_useState10[1];useEffect(function(){setLoadingPage(true);api.get('/users').then(function(response){return setUsers(response.data);}).catch(function(){toast.error('Erro ao carregar usuários! Por favor, tente novamente mais tarde.');}).finally(function(){setLoadingPage(false);});},[]);useEffect(function(){api.get('/profiles').then(function(response){return setProfiles(response.data);}).catch(function(){toast.error('Erro ao carregar perfis! Por favor, tente novamente mais tarde.');});},[]);var handleGetUser=useCallback(function(data){var _formRef$current,_formRef$current2;setUserId(data.id);(_formRef$current=formRef.current)===null||_formRef$current===void 0?void 0:_formRef$current.setErrors({});(_formRef$current2=formRef.current)===null||_formRef$current2===void 0?void 0:_formRef$current2.setData(data);},[]);var handleUngetUser=useCallback(function(){var _formRef$current3,_formRef$current4;setUserId('');(_formRef$current3=formRef.current)===null||_formRef$current3===void 0?void 0:_formRef$current3.setErrors({});(_formRef$current4=formRef.current)===null||_formRef$current4===void 0?void 0:_formRef$current4.reset();},[]);var handleAddUser=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data,_ref){var reset,_formRef$current5,response,_formRef$current6,errors;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:reset=_ref.reset;if(!loadingSubmit){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setLoadingSubmit(true);_context.prev=4;(_formRef$current5=formRef.current)===null||_formRef$current5===void 0?void 0:_formRef$current5.setErrors({});_context.next=8;return userSchema.validate(data,{abortEarly:false});case 8:_context.next=10;return api.post('/users',data);case 10:response=_context.sent;setUsers([].concat(_toConsumableArray(users),[response.data]));reset();toast.success('Usuário criado com sucesso!');_context.next=23;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](4);if(!(_context.t0 instanceof YupValidationError)){_context.next=22;break;}errors=getValidationErrors(_context.t0);(_formRef$current6=formRef.current)===null||_formRef$current6===void 0?void 0:_formRef$current6.setErrors(errors);return _context.abrupt(\"return\");case 22:if(_context.t0.response){toast.error(\"Erro ao criar usu\\xE1rio: \".concat(_context.t0.response.data.message));}else{toast.error('Erro interno do servidor! Por favor, tente novamente mais tarde.');}case 23:_context.prev=23;setLoadingSubmit(false);return _context.finish(23);case 26:case\"end\":return _context.stop();}}},_callee,null,[[4,16,23,26]]);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}(),[users,loadingSubmit]);var handleUpdateUser=useCallback(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data,_ref3){var reset,_formRef$current7,response,usersWithoutEdited,_formRef$current8,errors;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:reset=_ref3.reset;if(!loadingSubmit){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:setLoadingSubmit(true);_context2.prev=4;(_formRef$current7=formRef.current)===null||_formRef$current7===void 0?void 0:_formRef$current7.setErrors({});_context2.next=8;return userSchema.validate(data,{abortEarly:false});case 8:_context2.next=10;return api.put(\"/users/\".concat(userId),data);case 10:response=_context2.sent;usersWithoutEdited=users.filter(function(user){return user.id!==userId;});setUsers([].concat(_toConsumableArray(usersWithoutEdited),[response.data]));setUserId('');reset();toast.success('Usuário atualizado com sucesso!');_context2.next=25;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](4);if(!(_context2.t0 instanceof YupValidationError)){_context2.next=24;break;}errors=getValidationErrors(_context2.t0);(_formRef$current8=formRef.current)===null||_formRef$current8===void 0?void 0:_formRef$current8.setErrors(errors);return _context2.abrupt(\"return\");case 24:if(_context2.t0.response){toast.error(\"Erro ao atualizar usu\\xE1rio: \".concat(_context2.t0.response.data.message));}else{toast.error('Erro interno do servidor! Por favor, tente novamente mais tarde.');}case 25:_context2.prev=25;setLoadingSubmit(false);return _context2.finish(25);case 28:case\"end\":return _context2.stop();}}},_callee2,null,[[4,18,25,28]]);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}(),[users,userId,loadingSubmit]);return/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Loading,{show:loadingPage}),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(Aside,null),/*#__PURE__*/React.createElement(Main,null,/*#__PURE__*/React.createElement(Title,{title:\"Gerenciar usu\\xE1rios\"}),/*#__PURE__*/React.createElement(DoubleColumn,null,/*#__PURE__*/React.createElement(Form,{ref:formRef,onSubmit:!userId?handleAddUser:handleUpdateUser},/*#__PURE__*/React.createElement(Input,{placeholder:\"Usu\\xE1rio\",name:\"username\",icon:FiUser}),/*#__PURE__*/React.createElement(Input,{placeholder:\"Senha\",name:\"password\",type:\"password\",icon:FiLock}),/*#__PURE__*/React.createElement(Select,{name:\"profile_id\",icon:FiBriefcase,defaultValue:\"null\"},/*#__PURE__*/React.createElement(\"option\",{value:\"null\"},\"Selecionar perfil\"),profiles.map(function(profile){return/*#__PURE__*/React.createElement(\"option\",{key:profile.id,value:profile.id},profile.name);})),/*#__PURE__*/React.createElement(ButtonGroup,null,!userId?/*#__PURE__*/React.createElement(Button,{type:\"submit\",loading:loadingSubmit},\"Adicionar\"):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{type:\"submit\",loading:loadingSubmit},\"Atualizar\"),/*#__PURE__*/React.createElement(Button,{type:\"submit\",backgroundColor:\"#f44336\",onClick:handleUngetUser},\"Cancelar\")))),users.length>0&&/*#__PURE__*/React.createElement(UsersList,null,users.map(function(user){return/*#__PURE__*/React.createElement(\"li\",{key:user.id},/*#__PURE__*/React.createElement(FiEdit2,{size:20,onClick:function onClick(){return handleGetUser(user);}}),/*#__PURE__*/React.createElement(\"span\",null,user.username));})))));};export default Users;","map":{"version":3,"sources":["/home/ondaniel/santiago/sisgie/new_frontend/src/pages/Users/index.tsx"],"names":["React","useState","useCallback","useEffect","useRef","Form","FiUser","FiBriefcase","FiLock","FiEdit2","ValidationError","YupValidationError","toast","Container","Main","ButtonGroup","DoubleColumn","Loading","Header","Aside","Title","Input","Select","Button","UsersList","api","userSchema","getValidationErrors","Users","formRef","users","setUsers","profiles","setProfiles","userId","setUserId","loadingPage","setLoadingPage","loadingSubmit","setLoadingSubmit","get","then","response","data","catch","error","finally","handleGetUser","id","current","setErrors","setData","handleUngetUser","reset","handleAddUser","validate","abortEarly","post","success","errors","message","handleUpdateUser","put","usersWithoutEdited","filter","user","map","profile","name","length","username"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect, useRef } from 'react';\nimport { FormHandles } from '@unform/core';\nimport { Form } from '@unform/web';\nimport { FiUser, FiBriefcase, FiLock, FiEdit2 } from 'react-icons/fi';\nimport { ValidationError as YupValidationError } from 'yup';\nimport { toast } from 'react-toastify';\n\nimport { Container, Main, ButtonGroup, DoubleColumn } from './styles';\nimport Loading from '../../components/Loading';\nimport Header from '../../components/Header';\nimport Aside from '../../components/Aside';\nimport Title from '../../components/Title';\nimport Input from '../../components/Input';\nimport Select from '../../components/Select';\nimport Button from '../../components/Button';\nimport UsersList from '../../components/List';\nimport IUser from '../../entities/IUser';\nimport IProfile from '../../entities/IProfile';\nimport api from '../../services/api';\nimport userSchema from '../../schemas/userSchema';\nimport getValidationErrors from '../../utils/getValidationErrors';\n\nconst Users: React.FC = () => {\n  const formRef = useRef<FormHandles>(null);\n\n  const [users, setUsers] = useState([] as IUser[]);\n  const [profiles, setProfiles] = useState([] as IProfile[]);\n  const [userId, setUserId] = useState('');\n  const [loadingPage, setLoadingPage] = useState(false);\n  const [loadingSubmit, setLoadingSubmit] = useState(false);\n\n  useEffect(() => {\n    setLoadingPage(true);\n    api\n      .get('/users')\n      .then(response => setUsers(response.data))\n      .catch(() => {\n        toast.error(\n          'Erro ao carregar usuários! Por favor, tente novamente mais tarde.',\n        );\n      })\n      .finally(() => {\n        setLoadingPage(false);\n      });\n  }, []);\n\n  useEffect(() => {\n    api\n      .get('/profiles')\n      .then(response => setProfiles(response.data))\n      .catch(() => {\n        toast.error(\n          'Erro ao carregar perfis! Por favor, tente novamente mais tarde.',\n        );\n      });\n  }, []);\n\n  const handleGetUser = useCallback((data: Omit<IUser, 'profile'>) => {\n    setUserId(data.id);\n\n    formRef.current?.setErrors({});\n\n    formRef.current?.setData(data);\n  }, []);\n\n  const handleUngetUser = useCallback(() => {\n    setUserId('');\n\n    formRef.current?.setErrors({});\n\n    formRef.current?.reset();\n  }, []);\n\n  const handleAddUser = useCallback(\n    async (data: Omit<IUser, 'id' | 'profile'>, { reset }) => {\n      if (loadingSubmit) {\n        return;\n      }\n\n      setLoadingSubmit(true);\n\n      try {\n        formRef.current?.setErrors({});\n\n        await userSchema.validate(data, {\n          abortEarly: false,\n        });\n\n        const response = await api.post('/users', data);\n\n        setUsers([...users, response.data]);\n\n        reset();\n\n        toast.success('Usuário criado com sucesso!');\n      } catch (err) {\n        if (err instanceof YupValidationError) {\n          const errors = getValidationErrors(err);\n          formRef.current?.setErrors(errors);\n          return;\n        }\n\n        if (err.response) {\n          toast.error(`Erro ao criar usuário: ${err.response.data.message}`);\n        } else {\n          toast.error(\n            'Erro interno do servidor! Por favor, tente novamente mais tarde.',\n          );\n        }\n      } finally {\n        setLoadingSubmit(false);\n      }\n    },\n    [users, loadingSubmit],\n  );\n\n  const handleUpdateUser = useCallback(\n    async (data: Omit<IUser, 'id' | 'profile'>, { reset }) => {\n      if (loadingSubmit) {\n        return;\n      }\n\n      setLoadingSubmit(true);\n\n      try {\n        formRef.current?.setErrors({});\n\n        await userSchema.validate(data, {\n          abortEarly: false,\n        });\n\n        const response = await api.put(`/users/${userId}`, data);\n\n        const usersWithoutEdited = users.filter(user => user.id !== userId);\n\n        setUsers([...usersWithoutEdited, response.data]);\n\n        setUserId('');\n\n        reset();\n\n        toast.success('Usuário atualizado com sucesso!');\n      } catch (err) {\n        if (err instanceof YupValidationError) {\n          const errors = getValidationErrors(err);\n          formRef.current?.setErrors(errors);\n          return;\n        }\n\n        if (err.response) {\n          toast.error(\n            `Erro ao atualizar usuário: ${err.response.data.message}`,\n          );\n        } else {\n          toast.error(\n            'Erro interno do servidor! Por favor, tente novamente mais tarde.',\n          );\n        }\n      } finally {\n        setLoadingSubmit(false);\n      }\n    },\n    [users, userId, loadingSubmit],\n  );\n\n  return (\n    <Container>\n      <Loading show={loadingPage} />\n\n      <Header />\n\n      <Aside />\n\n      <Main>\n        <Title title=\"Gerenciar usuários\" />\n\n        <DoubleColumn>\n          <Form\n            ref={formRef}\n            onSubmit={!userId ? handleAddUser : handleUpdateUser}\n          >\n            <Input placeholder=\"Usuário\" name=\"username\" icon={FiUser} />\n\n            <Input\n              placeholder=\"Senha\"\n              name=\"password\"\n              type=\"password\"\n              icon={FiLock}\n            />\n\n            <Select name=\"profile_id\" icon={FiBriefcase} defaultValue=\"null\">\n              <option value=\"null\">Selecionar perfil</option>\n              {profiles.map(profile => (\n                <option key={profile.id} value={profile.id}>\n                  {profile.name}\n                </option>\n              ))}\n            </Select>\n\n            <ButtonGroup>\n              {!userId ? (\n                <Button type=\"submit\" loading={loadingSubmit}>\n                  Adicionar\n                </Button>\n              ) : (\n                <>\n                  <Button type=\"submit\" loading={loadingSubmit}>\n                    Atualizar\n                  </Button>\n\n                  <Button\n                    type=\"submit\"\n                    backgroundColor=\"#f44336\"\n                    onClick={handleUngetUser}\n                  >\n                    Cancelar\n                  </Button>\n                </>\n              )}\n            </ButtonGroup>\n          </Form>\n\n          {users.length > 0 && (\n            <UsersList>\n              {users.map(user => (\n                <li key={user.id}>\n                  <FiEdit2 size={20} onClick={() => handleGetUser(user)} />\n                  {/* <FiTrash\n                    size={20}\n                    onClick={() => handleRemoveUser(user.id)}\n                  /> */}\n                  <span>{user.username}</span>\n                </li>\n              ))}\n            </UsersList>\n          )}\n        </DoubleColumn>\n      </Main>\n    </Container>\n  );\n};\n\nexport default Users;\n"]},"metadata":{},"sourceType":"module"}