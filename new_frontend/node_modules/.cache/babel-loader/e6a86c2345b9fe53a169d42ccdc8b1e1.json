{"ast":null,"code":"import _objectWithoutProperties from\"/home/ondaniel/santiago/sisgie/new_frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import React,{useCallback}from'react';import{Route as ReactDOMRoute,Redirect}from'react-router-dom';import{useAuth}from'../hooks/auth';var Route=function Route(_ref){var _ref$isPrivate=_ref.isPrivate,isPrivate=_ref$isPrivate===void 0?false:_ref$isPrivate,Component=_ref.component,needPermissions=_ref.needPermissions,rest=_objectWithoutProperties(_ref,[\"isPrivate\",\"component\",\"needPermissions\"]);var _useAuth=useAuth(),user=_useAuth.user;var checkForPermissions=useCallback(function(){var authorized=false;if(needPermissions){needPermissions.forEach(function(permiss){if(user.profile[permiss]){authorized=true;}});}else{authorized=true;}return authorized;},[needPermissions,user]);return/*#__PURE__*/React.createElement(ReactDOMRoute,Object.assign({},rest,{render:function render(_ref2){var location=_ref2.location;return isPrivate===!!user&&checkForPermissions()?/*#__PURE__*/React.createElement(Component,null):/*#__PURE__*/React.createElement(Redirect,{to:{pathname:isPrivate?'/':'/dashboard',state:{from:location}}});}}));};export default Route;","map":{"version":3,"sources":["/home/ondaniel/santiago/sisgie/new_frontend/src/routes/Route.tsx"],"names":["React","useCallback","Route","ReactDOMRoute","Redirect","useAuth","isPrivate","Component","component","needPermissions","rest","user","checkForPermissions","authorized","forEach","permiss","profile","location","pathname","state","from"],"mappings":"kJAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,KAAmC,OAAnC,CACA,OAEEC,KAAK,GAAIC,CAAAA,aAFX,CAGEC,QAHF,KAIO,kBAJP,CAMA,OAASC,OAAT,KAAwB,eAAxB,CAkBA,GAAMH,CAAAA,KAA2B,CAAG,QAA9BA,CAAAA,KAA8B,MAK9B,yBAJJI,SAII,CAJJA,SAII,yBAJQ,KAIR,gBAHOC,SAGP,MAHJC,SAGI,CAFJC,eAEI,MAFJA,eAEI,CADDC,IACC,yFACaL,OAAO,EADpB,CACIM,IADJ,UACIA,IADJ,CAGJ,GAAMC,CAAAA,mBAAmB,CAAGX,WAAW,CAAC,UAAM,CAC5C,GAAIY,CAAAA,UAAU,CAAG,KAAjB,CAEA,GAAIJ,eAAJ,CAAqB,CACnBA,eAAe,CAACK,OAAhB,CAAwB,SAAAC,OAAO,CAAI,CACjC,GAAIJ,IAAI,CAACK,OAAL,CAAaD,OAAb,CAAJ,CAA2B,CACzBF,UAAU,CAAG,IAAb,CACD,CACF,CAJD,EAKD,CAND,IAMO,CACLA,UAAU,CAAG,IAAb,CACD,CAED,MAAOA,CAAAA,UAAP,CACD,CAdsC,CAcpC,CAACJ,eAAD,CAAkBE,IAAlB,CAdoC,CAAvC,CAgBA,mBACE,oBAAC,aAAD,kBACMD,IADN,EAEE,MAAM,CAAE,sBAAkB,IAAfO,CAAAA,QAAe,OAAfA,QAAe,CACxB,MAAOX,CAAAA,SAAS,GAAK,CAAC,CAACK,IAAhB,EAAwBC,mBAAmB,EAA3C,cACL,oBAAC,SAAD,MADK,cAGL,oBAAC,QAAD,EACE,EAAE,CAAE,CACFM,QAAQ,CAAEZ,SAAS,CAAG,GAAH,CAAS,YAD1B,CAEFa,KAAK,CAAE,CAAEC,IAAI,CAAEH,QAAR,CAFL,CADN,EAHF,CAUD,CAbH,GADF,CAiBD,CAzCD,CA2CA,cAAef,CAAAA,KAAf","sourcesContent":["import React, { useCallback } from 'react';\nimport {\n  RouteProps as ReactDOMRouteProps,\n  Route as ReactDOMRoute,\n  Redirect,\n} from 'react-router-dom';\n\nimport { useAuth } from '../hooks/auth';\n\ninterface RouteProps extends ReactDOMRouteProps {\n  isPrivate?: boolean;\n  component: React.ComponentType;\n  needPermissions?: (\n    | 'create_new_enrollments_permiss'\n    | 'validate_enrollments_permiss'\n    | 'create_extra_debits_permiss'\n    | 'pay_debits_permiss'\n    | 'discharge_payments_permiss'\n    | 'crud_profiles_permiss'\n    | 'crud_users_permiss'\n    | 'crud_grades_permiss'\n    | 'crud_extra_debits_permiss'\n  )[];\n}\n\nconst Route: React.FC<RouteProps> = ({\n  isPrivate = false,\n  component: Component,\n  needPermissions,\n  ...rest\n}) => {\n  const { user } = useAuth();\n\n  const checkForPermissions = useCallback(() => {\n    let authorized = false;\n\n    if (needPermissions) {\n      needPermissions.forEach(permiss => {\n        if (user.profile[permiss]) {\n          authorized = true;\n        }\n      });\n    } else {\n      authorized = true;\n    }\n\n    return authorized;\n  }, [needPermissions, user]);\n\n  return (\n    <ReactDOMRoute\n      {...rest}\n      render={({ location }) => {\n        return isPrivate === !!user && checkForPermissions() ? (\n          <Component />\n        ) : (\n          <Redirect\n            to={{\n              pathname: isPrivate ? '/' : '/dashboard',\n              state: { from: location },\n            }}\n          />\n        );\n      }}\n    />\n  );\n};\n\nexport default Route;\n"]},"metadata":{},"sourceType":"module"}